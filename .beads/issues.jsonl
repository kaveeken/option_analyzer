{"id":"option_returns-0on","title":"Phase 2: Statistical Engine","description":"Price distribution modeling and risk metrics\n\nTasks:\n- [ ] Implement geometric returns, bootstrap\n- [ ] Direct returns vs Monte Carlo modes\n- [ ] Price range calculation (auto + user override)\n- [ ] Histogram binning\n- [ ] Risk metrics (EV, PoP) with transaction costs\n- [ ] Comprehensive unit tests\n- [ ] Performance benchmarks (bootstrap simulation)\n\nDeliverables:\n- Bootstrap simulation (10k samples \u003c5s)\n- Price distribution functions\n- Risk calculation engine\n- Test coverage \u003e90%\n\nSuccess Criteria:\n- 10,000 simulations complete in \u003c5 seconds\n- Price range auto-calculated with 5% padding\n- Transaction costs included in all metrics","status":"open","priority":0,"issue_type":"feature","created_at":"2025-12-19T21:53:21.821557539+01:00","updated_at":"2025-12-19T21:53:21.821557539+01:00","dependencies":[{"issue_id":"option_returns-0on","depends_on_id":"option_returns-yaf","type":"blocks","created_at":"2025-12-19T21:54:20.9232971+01:00","created_by":"daemon"}]}
{"id":"option_returns-4cu","title":"Document or validate negative days_to_expiry behavior","description":"The days_to_expiry() method can return negative values when reference_date is after expiration, but this is undocumented.\n\nIssues:\n- Unclear if negative values are intentional (for historical analysis) or a bug\n- No documentation about this edge case\n- No tests for past expiration scenarios\n- Calculations using this value might assume positive values\n\nSolution: Either add explicit documentation explaining negative values are allowed for historical analysis, OR add validation to raise ValueError if reference_date \u003e expiration.\n\nFile: src/option_analyzer/models/domain.py:90-101","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T09:22:09.487959694+01:00","updated_at":"2025-12-21T16:19:13.01000432+01:00","closed_at":"2025-12-21T16:19:13.01000432+01:00","close_reason":"Added validation to raise ValueError when reference_date is after expiration. Updated docstring and added comprehensive test coverage."}
{"id":"option_returns-azx","title":"Add validate_for_analysis() method to Strategy","description":"Add a comprehensive validation method to Strategy that checks if it's ready for analysis.\n\nShould validate:\n- Single expiration (all options expire on same date)\n- All option positions have valid bid/ask data\n- At least one position exists (optional)\n\nLocation: src/option_analyzer/models/domain.py (Strategy class)\n\nImplementation:\ndef validate_for_analysis(self) -\u003e None:\n    if not self.validate_single_expiration():\n        raise MixedExpirationError()\n    for pos in self.option_positions:\n        if pos.contract.bid is None or pos.contract.ask is None:\n            raise MissingBidAskError(f'Missing price data for contract {pos.contract.conid}')\n\nBenefits:\n- Fail fast before expensive calculations\n- Clear error messages\n- Single method to call before any analysis\n- Can be extended with additional validations","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T22:12:42.378167697+01:00","updated_at":"2025-12-21T21:15:11.38169971+01:00","closed_at":"2025-12-21T21:15:11.38169971+01:00","close_reason":"Closed"}
{"id":"option_returns-b8y","title":"Phase 7: Polish \u0026 Deployment","description":"Final polish and deployment readiness\n\nTasks:\n- [ ] Logging \u0026 observability\n- [ ] Performance optimization\n- [ ] Documentation\n- [ ] Deployment guide\n\nDeliverables:\n- Structured logging\n- Performance monitoring\n- User documentation\n- Deployment instructions\n\nSuccess Criteria:\n- All success criteria met\n- Documentation complete\n- Ready for single-user local deployment","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-19T21:53:23.863301009+01:00","updated_at":"2025-12-19T21:53:23.863301009+01:00","dependencies":[{"issue_id":"option_returns-b8y","depends_on_id":"option_returns-iol","type":"blocks","created_at":"2025-12-19T21:54:21.153277891+01:00","created_by":"daemon"}]}
{"id":"option_returns-dcz","title":"Phase 4: API Layer","description":"FastAPI routes with session management\n\nTasks:\n- [ ] Session state service with cookie management\n- [ ] Session cleanup background task (every 5 min)\n- [ ] Automatic target date selection (earliest expiration)\n- [ ] Request validation (Pydantic schemas)\n- [ ] Standardized error responses\n- [ ] FastAPI routes with session dependency injection\n- [ ] Position modification endpoints (PATCH, DELETE)\n- [ ] Strategy summary endpoint\n- [ ] Change reset to POST (not DELETE)\n- [ ] API integration tests with validation checks\n\nDeliverables:\n- All REST endpoints implemented\n- Session management with cookies\n- Validation and error handling\n- Auto-documentation at /docs\n\nSuccess Criteria:\n- Sessions persist across requests\n- Mixed expiration rejected with MIXED_EXPIRATION error\n- Auto target date selection works\n- All endpoints return standardized errors","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-19T21:53:22.714365181+01:00","updated_at":"2025-12-19T21:53:22.714365181+01:00","dependencies":[{"issue_id":"option_returns-dcz","depends_on_id":"option_returns-tgg","type":"blocks","created_at":"2025-12-19T21:54:21.018660374+01:00","created_by":"daemon"}]}
{"id":"option_returns-dia","title":"Modernize deprecated type hints to Python 3.11+ syntax","description":"Update deprecated typing imports and type hints to modern Python 3.11+ syntax.\n\nCurrent violations (8 total):\n- UP035: typing.List is deprecated, use list instead\n- UP006: Use list instead of List for type annotations\n- UP045: Use X | None instead of Optional[X]\n\nFiles affected:\n- src/option_analyzer/models/domain.py (lines 12, 33, 66-67, 90, 183, 235)\n- src/option_analyzer/config.py (line 38)\n\nChanges needed:\n- List[date] → list[date]\n- Optional[float] → float | None\n- Optional[date] → date | None\n- List[OptionPosition] → list[OptionPosition]\n\nSolution: Run 'ruff check --fix' to auto-fix all violations (~2 minutes work).\n\nThis should be done before Phase 2 to maintain modern Python standards.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T09:26:51.761246547+01:00","updated_at":"2025-12-21T16:10:22.348925618+01:00","closed_at":"2025-12-21T16:10:22.348925618+01:00","close_reason":"Closed"}
{"id":"option_returns-gk1","title":"Phase 5: Visualization","description":"Strategy plot generation with matplotlib\n\nTasks:\n- [ ] Matplotlib chart generation (async with thread pool)\n- [ ] Per-session plot file naming\n- [ ] Plot directory creation and cleanup\n- [ ] Plot caching\n- [ ] Visual regression tests\n\nDeliverables:\n- Dual-axis chart (histogram + P\u0026L curve)\n- Session-isolated plot files\n- Async rendering (non-blocking)\n\nSuccess Criteria:\n- Plot generation doesn't block requests\n- Plots saved as /static/plots/{session_id}_{timestamp}.png\n- Old plots cleaned up with sessions","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-19T21:53:23.098098833+01:00","updated_at":"2025-12-19T21:53:23.098098833+01:00","dependencies":[{"issue_id":"option_returns-gk1","depends_on_id":"option_returns-dcz","type":"blocks","created_at":"2025-12-19T21:54:21.064077655+01:00","created_by":"daemon"}]}
{"id":"option_returns-gwz","title":"Refactor RateLimiter.acquire() to reduce cyclomatic complexity","description":"The acquire() method in rate_limiter.py has cyclomatic complexity of 7 due to duplicated cleanup logic.\n\nCurrent issues:\n- Cleanup logic repeated at lines 52-53 and 62-63\n- Nested while loops make testing edge cases harder\n- Difficult to maintain for future developers\n\nSolution: Extract cleanup as private _cleanup_expired_requests() method to eliminate duplication and reduce complexity.\n\nFile: src/option_analyzer/utils/rate_limiter.py:39-66","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T09:22:09.152376727+01:00","updated_at":"2025-12-21T16:19:28.151106582+01:00","closed_at":"2025-12-21T16:19:28.151106582+01:00","close_reason":"Closed"}
{"id":"option_returns-h04","title":"Raise MissingBidAskError when option price data is unavailable","description":"Currently OptionPosition.premium_paid defaults to 0.0 when bid/ask is None. This can lead to incorrect P\u0026L calculations. Update to raise MissingBidAskError instead to catch missing price data early.\n\nLocation: src/option_analyzer/models/domain.py:143-148\n\nChanges needed:\n- Update premium_paid property to validate bid/ask is not None\n- Raise MissingBidAskError with helpful message indicating which contract\n- Update tests to verify error is raised\n- Consider adding a has_price_data() helper method\n\nImpact: Prevents silent failures in analysis when price data is missing","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T22:12:42.041132593+01:00","updated_at":"2025-12-19T22:12:42.041132593+01:00"}
{"id":"option_returns-iol","title":"Phase 6: Frontend","description":"Web UI with vanilla JavaScript\n\nTasks:\n- [ ] HTML/CSS structure\n- [ ] Loading state UI (spinners, disabled buttons)\n- [ ] Error display component\n- [ ] Modular JavaScript with state management\n- [ ] Position modification UI (edit, delete)\n- [ ] Strategy summary display\n- [ ] Analysis parameters controls (historical years, price range)\n- [ ] Event handling\n- [ ] Playwright E2E tests\n\nDeliverables:\n- Responsive web interface\n- Loading states for all operations\n- Position management UI\n- E2E test suite\n\nSuccess Criteria:\n- Mobile-responsive design\n- Loading states prevent user confusion\n- Errors display with clear messages\n- E2E tests cover critical user flows","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-19T21:53:23.479622932+01:00","updated_at":"2025-12-19T21:53:23.479622932+01:00","dependencies":[{"issue_id":"option_returns-iol","depends_on_id":"option_returns-gk1","type":"blocks","created_at":"2025-12-19T21:54:21.108735622+01:00","created_by":"daemon"}]}
{"id":"option_returns-tgg","title":"Phase 3: IBKR Integration","description":"Interactive Brokers API client with rate limiting\n\nTasks:\n- [ ] HTTPX client with rate limiting\n- [ ] Retry logic with exponential backoff\n- [ ] Cache layer\n- [ ] Stock/chain/history endpoints (configurable years)\n- [ ] Error handling (IBKR down, symbol not found, rate limited)\n- [ ] Mock-based integration tests\n- [ ] Optional: Real IBKR integration tests\n\nDeliverables:\n- IBKRClient with rate limiting (50 req/60s)\n- Retry logic with exponential backoff\n- Cache interface with in-memory implementation\n- Comprehensive error handling\n\nSuccess Criteria:\n- Rate limiting prevents IBKR bans\n- Retries handle transient failures\n- Cache reduces redundant API calls","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-19T21:53:32.871650723+01:00","updated_at":"2025-12-19T21:53:32.871650723+01:00","dependencies":[{"issue_id":"option_returns-tgg","depends_on_id":"option_returns-0on","type":"blocks","created_at":"2025-12-19T21:54:20.976537994+01:00","created_by":"daemon"}]}
{"id":"option_returns-yaf","title":"Phase 1: Foundation","description":"Project setup and core domain models\n\nTasks:\n- [ ] Project setup (pyproject.toml, directory structure)\n- [ ] Configuration management (including transaction costs, historical years)\n- [ ] Domain models (with validation, single-expiration check)\n- [ ] Custom exceptions (IBKRAPIError, validation errors)\n- [ ] Rate limiter utility\n- [ ] Unit tests for models and validation\n\nDeliverables:\n- Working domain models (Stock, OptionContract, OptionPosition, Strategy)\n- Validation logic (single-expiration, zero quantity)\n- Configuration with Pydantic settings\n- 90%+ test coverage for models","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-19T21:53:14.537949317+01:00","updated_at":"2025-12-19T22:06:41.351390928+01:00","closed_at":"2025-12-19T22:06:41.351390928+01:00","close_reason":"Phase 1 foundation complete with 94.63% test coverage"}
